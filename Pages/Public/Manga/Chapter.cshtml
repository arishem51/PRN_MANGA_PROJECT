@page "{chapterId:int}"
@model PRN_MANGA_PROJECT.Pages.Public.Manga.ChapterModel
@{
}

@section Styles {
	<link rel="stylesheet" href="~/css/Comment.css" />
	<style>
		.chapter-navigation {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			border-radius: 10px;
			padding: 20px;
			margin: 20px 0;
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
		}
		
		.navigation-instruction {
			background: rgba(255,255,255,0.9);
			border-radius: 8px;
			padding: 15px;
			margin-bottom: 20px;
			text-align: center;
			font-style: italic;
			color: #333;
			font-size: 16px;
		}
		
		.nav-buttons {
			display: flex;
			justify-content: center;
			gap: 20px;
		}
		
		.nav-btn {
			padding: 12px 24px;
			border: none;
			border-radius: 8px;
			font-size: 16px;
			font-weight: 600;
			text-decoration: none;
			transition: all 0.3s ease;
			display: inline-flex;
			align-items: center;
			gap: 8px;
		}
		
		.nav-btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 20px rgba(0,0,0,0.2);
		}
		
		.nav-btn.prev {
			background: #6c757d;
			color: white;
		}
		
		.nav-btn.next {
			background: #007bff;
			color: white;
		}
		
		.nav-btn:disabled {
			background: #e9ecef;
			color: #6c757d;
			cursor: not-allowed;
			transform: none;
		}
		
		.nav-btn:disabled:hover {
			transform: none;
			box-shadow: none;
		}
		
		.chapter-images {
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		
		.chapter-image-container {
			text-align: center;
			width: 100%;
		}
		
		.chapter-image-container img {
			max-width: 100%;
			height: auto;
			display: block;
			margin: 0 auto;
		}
	</style>
}
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

<!-- Chapter Navigation -->
<div class="chapter-navigation">
	<div class="navigation-instruction">
		Sử dụng mũi tên trái (←) hoặc phải (→) để chuyển chapter
	</div>
	
	<div class="nav-buttons">
		@if (Model.PreviousChapterId.HasValue)
		{
			<a href="/Public/Manga/Chapter/@Model.PreviousChapterId" class="nav-btn prev">
				<i class="fa fa-arrow-left"></i>
				Chap Trước
			</a>
		}
		else
		{
			<button class="nav-btn prev" disabled>
				<i class="fa fa-arrow-left"></i>
				Chap Trước
			</button>
		}
		
		@if (Model.NextChapterId.HasValue)
		{
			<a href="/Public/Manga/Chapter/@Model.NextChapterId" class="nav-btn next">
				Chap Sau
				<i class="fa fa-arrow-right"></i>
			</a>
		}
		else
		{
			<button class="nav-btn next" disabled>
				Chap Sau
				<i class="fa fa-arrow-right"></i>
			</button>
		}
	</div>
</div>

<div>
	<h1>@Model.Chapter.Title</h1>
	
	@if (Model.ChapterImages != null && Model.ChapterImages.Any())
	{
		<div class="chapter-images">
			@foreach (var image in Model.ChapterImages)
			{
				<div class="chapter-image-container mb-3">
					<img src="@image.ImageUrl" alt="Chapter Image @image.PageNumber" class="img-fluid" />
				</div>
			}
		</div>
	}
	else if (!string.IsNullOrEmpty(Model.Chapter.Content))
	{
		<div class="chapter-content">
			@Html.Raw(Model.Chapter.Content)
		</div>
	}
	else
	{
		<div class="alert alert-warning">
			<p>Không có nội dung hoặc hình ảnh cho chapter này.</p>
		</div>
	}
</div>

<form method="post" asp-page-handler="Comment">
	<div class="panel">
		<div class="panel-body">
			<input type="hidden" asp-for="Input.ChapterId" value="@Model.Chapter.Id" />
			<textarea class="form-control" rows="2" placeholder="What are you thinking?" asp-for="Input.Content"></textarea>
			<div class="mar-top clearfix">
				<button class="btn btn-sm btn-primary pull-right" type="submit"><i class="fa fa-pencil fa-fw"></i> Share</button>
				<a class="btn btn-trans btn-icon fa fa-video-camera add-tooltip" href="#"></a>
				<a class="btn btn-trans btn-icon fa fa-camera add-tooltip" href="#"></a>
				<a class="btn btn-trans btn-icon fa fa-file add-tooltip" href="#"></a>
			</div>
		</div>
	</div>
</form>


<partial name="~/Pages/Shared/Partial/_CommentPartial.cshtml" model="@Model.Comments"/>

@section Scripts {
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			// Keyboard navigation
			document.addEventListener('keydown', function(e) {
				// Left arrow key - Previous chapter
				if (e.key === 'ArrowLeft' && @(Model.PreviousChapterId?.ToString() ?? "null") !== null) {
					window.location.href = '/Public/Manga/Chapter/@Model.PreviousChapterId';
				}
				// Right arrow key - Next chapter
				else if (e.key === 'ArrowRight' && @(Model.NextChapterId?.ToString() ?? "null") !== null) {
					window.location.href = '/Public/Manga/Chapter/@Model.NextChapterId';
				}
			});
		});
	</script>
}